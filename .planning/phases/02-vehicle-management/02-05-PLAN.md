---
phase: 02-vehicle-management
plan: 05
type: execute
wave: 4
depends_on: ['02-02', '02-03', '02-04']
files_modified: []
autonomous: false

must_haves:
  truths:
    - 'User can create a vehicle with all required fields'
    - 'User can add optional technical data'
    - 'User can view list of vehicles with visual fuel type indicators'
    - 'User can view vehicle details'
    - 'User can edit vehicle data'
    - 'User can delete vehicle with confirmation'
  artifacts: []
  key_links: []
---

<objective>
Verify that all Phase 2 vehicle management features work correctly through comprehensive manual testing.

Purpose: Confirm all VEHI requirements (VEHI-01 through VEHI-06) are met and the complete CRUD flow functions as designed per CONTEXT.md decisions.

Output: Verified vehicle management system ready for Phase 3 (fueling records).
</objective>

<execution_context>
@/home/bweber/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/bweber/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-vehicle-management/02-CONTEXT.md
@.planning/REQUIREMENTS.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete vehicle management system with CRUD operations:
- Schema simplified with direct fields (no lookup table dependencies)
- Vehicle list with empty state and enhanced cards
- Create form with basic and technical data sections
- Edit form with all fields
- Vehicle detail page
- Delete confirmation modal
  </what-built>
  
  <how-to-verify>
Run `npm run dev` and test the complete flow:

**1. Empty State (VEHI-03)**

- Sign in to the application
- Navigate to `/vehicles`
- Verify empty state appears with encouraging message and "Add Vehicle" button

**2. Create Vehicle - Basic Fields (VEHI-01)**

- Click "Add Vehicle" button
- Fill required fields:
  - Brand: "Toyota"
  - Model: "Camry"
  - Production Year: 2020
  - Fuel Type: "gasoline"
  - Registration: "ABC 1234" (optional, test with and without)
- Submit form
- Verify redirect to `/vehicles`
- Verify success toast appears
- Verify vehicle card appears in list

**3. Create Vehicle - With Technical Data (VEHI-02)**

- Add another vehicle
- Fill basic fields
- Click "Add technical data" to expand section
- Fill technical fields:
  - Engine Capacity: 2000
  - Engine Power: 150
  - Power Unit: "HP"
  - Transmission: "automatic"
- Submit and verify

**4. Vehicle List Display (VEHI-03)**

- Verify vehicle cards show:
  - Fuel type icon/badge (â›½ for gasoline)
  - Brand and Model (prominent)
  - Production year
  - Registration number
- Verify responsive grid (1 col mobile, 2-3 cols desktop)
- Verify hover states on cards

**5. Vehicle Detail View (VEHI-06)**

- Click a vehicle card
- Verify navigation to `/vehicles/[id]`
- Verify detail page displays:
  - Vehicle header with brand, model, year
  - Fuel type icon and registration in subheading
  - Basic information card
  - Technical specifications card (if data exists)
  - Edit and Delete buttons
  - Placeholder message for Phase 3 features

**6. Edit Vehicle (VEHI-04)**

- Click "Edit Vehicle" button from detail page
- Verify all fields are pre-populated
- Modify brand to "Honda"
- Modify model to "Accord"
- Expand technical data and change power to 180
- Submit form
- Verify redirect to `/vehicles`
- Verify success toast
- Verify updated data appears in list and detail page

**7. Delete Vehicle (VEHI-05)**

- Go to vehicle detail page
- Click "Delete Vehicle" button
- Verify modal appears with:
  - Vehicle name in warning message
  - Clear warning about permanent deletion
  - Cancel and Delete buttons
- Click Cancel first - verify modal closes without action
- Click Delete button again to reopen modal
- Click "Delete Vehicle" button in modal
- Verify:
  - Success toast appears
  - Redirect to `/vehicles` list
  - Vehicle no longer appears in list
  - If no vehicles remain, empty state appears

**8. Form Validation**

- Try creating vehicle with empty required fields
- Verify form prevents submission or shows validation errors
- Try invalid year (e.g., 1800 or 2100)
- Verify appropriate handling

**9. Responsive Design**

- Test on mobile viewport (narrow browser window)
- Verify:
  - Vehicle cards stack to 1 column
  - Forms are usable on mobile
  - Detail page is readable on mobile
  - Navigation works (from Phase 1)

**10. Integration with Auth (from Phase 1)**

- Verify vehicles are user-specific (don't see other users' vehicles)
- Sign out and verify redirect to sign-in page
- Sign in and verify vehicles still visible

**Expected Outcomes:**

- All 6 VEHI requirements met
- Complete CRUD flow works smoothly
- Forms are easy to use and match CONTEXT.md design
- No console errors
- No TypeScript compilation errors
- Responsive design works on mobile and desktop
</how-to-verify>
  <resume-signal>
Type "approved" if all tests pass, or describe any issues found for gap closure planning.
  </resume-signal>
</task>

</tasks>

<verification>
All Phase 2 requirements verified:
- [ ] VEHI-01: User can create vehicle with basic data
- [ ] VEHI-02: User can add technical data to vehicle
- [ ] VEHI-03: User can view list of their vehicles
- [ ] VEHI-04: User can edit vehicle data
- [ ] VEHI-05: User can delete vehicle with confirmation
- [ ] VEHI-06: User can select vehicle to view details

All CONTEXT.md design decisions implemented:

- [ ] Forms have single-page layout (not wizard)
- [ ] Technical data section is collapsible
- [ ] Vehicle list has empty state
- [ ] Vehicle cards show fuel type icons
- [ ] Delete requires confirmation modal
- [ ] Detail page has placeholder for Phase 3 features
      </verification>

<success_criteria>
Complete vehicle management CRUD flow works correctly. All 6 requirements met. Forms match design decisions. Ready for Phase 3 (fueling records).
</success_criteria>

<output>
After completion, create `.planning/phases/02-vehicle-management/02-05-SUMMARY.md`
</output>
