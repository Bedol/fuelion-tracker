---
phase: 01-auth-app-shell
plan: 05
type: execute
wave: 3
depends_on: ['01-01', '01-02', '01-03', '01-04']
files_modified: []
autonomous: false

must_haves:
  truths:
    - 'User can sign in with Google OAuth successfully'
    - 'Signed-in user sees their name in navigation'
    - 'Session persists after browser close and reopen'
    - 'User can sign out and is redirected to sign-in page'
    - 'Unauthenticated user accessing home is redirected to sign-in'
    - 'Navigation works on both desktop and mobile viewports'
    - 'Language toggle switches interface between Polish and English'
    - 'SkeletonLoader shows during index page session loading'
    - 'ErrorAlert and SkeletonLoader components build without errors'
  artifacts:
    - path: 'pages/auth/signin.tsx'
      provides: 'Sign-in page rendering'
      status: 'renders correctly'
    - path: 'components/layout/Navigation.tsx'
      provides: 'Responsive navigation'
      status: 'adapts to viewport'
    - path: 'pages/index.tsx'
      provides: 'Protected home page'
      status: 'requires auth'
  key_links:
    - from: 'Sign-in flow'
      to: 'Session creation'
      via: 'Google OAuth redirect'
      status: 'working'
    - from: 'Navigation'
      to: 'Session data'
      via: 'useSession hook'
      status: 'displays user info'
    - from: 'Protected pages'
      to: 'Sign-in redirect'
      via: 'session check'
      status: 'redirects when unauthenticated'
---

<objective>
Verify that Phase 1 authentication and app shell work correctly through comprehensive manual testing.

Purpose: Validate all Phase 1 requirements (AUTH-01 through AUTH-04, UIUX-01, UIUX-06) are met. Ensure authentication flows, navigation, i18n, and loading/error states function as designed before moving to Phase 2.

Output: Confirmation that auth and app shell are production-ready for building vehicle management features in Phase 2.
</objective>

<execution_context>
@/home/bweber/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/bweber/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-auth-app-shell/01-CONTEXT.md
@.planning/phases/01-auth-app-shell/01-01-SUMMARY.md
@.planning/phases/01-auth-app-shell/01-02-SUMMARY.md
@.planning/phases/01-auth-app-shell/01-03-SUMMARY.md
@.planning/phases/01-auth-app-shell/01-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete authentication system with Google OAuth, responsive navigation (desktop top bar / mobile bottom bar), internationalization (Polish/English), and enhanced loading/error components.

Components delivered:

- Custom sign-in page with Fuelion branding at /auth/signin
- NextAuth configuration with JWT sessions and custom pages
- Protected home page (/) with session check and redirect
- Responsive Navigation component (desktop top bar, mobile bottom bar)
- AuthenticatedLayout with proper mobile bottom nav clearance
- LocaleContext with Polish/English language toggle
- SkeletonLoader component with page/list/card variants
- ErrorAlert component with collapsible technical details
- Updated Layout.tsx routing between authenticated/public layouts
  </what-built>
  <how-to-verify>
  **Prerequisites:**

1. Ensure environment variables are set:
   - GOOGLE_CLIENT_ID
   - GOOGLE_CLIENT_SECRET
   - NEXTAUTH_URL (http://localhost:3000 for dev)
   - NEXTAUTH_SECRET
2. Run `npm run dev` to start development server
3. Open browser to http://localhost:3000

**Test Sequence:**

**1. AUTH-01: Google OAuth Sign-In**

- Visit http://localhost:3000
- Should redirect to /auth/signin
- Verify sign-in page shows:
  - Fuelion heading with gas pump icon
  - "Sign in with Google" button with Google logo
  - Centered, minimal layout
- Click "Sign in with Google"
- Complete Google OAuth flow
- Should redirect back to http://localhost:3000
- Verify you see welcome message with your name

**2. AUTH-02: Session Persistence**

- While signed in, note your name displayed
- Close browser completely (not just tab)
- Reopen browser to http://localhost:3000
- Should still be signed in (no redirect to signin)
- Should still see welcome message with your name

**3. AUTH-03 & AUTH-04: Sign Out and Redirect**

- While signed in, find user avatar in navigation (top right on desktop)
- Click avatar to open menu
- Click "Sign Out" (should show "Wyloguj" in Polish or "Sign Out" in English)
- Should redirect to /auth/signin
- Try visiting http://localhost:3000 again
- Should redirect to /auth/signin (no longer authenticated)

**4. UIUX-01: Responsive Navigation**

- Sign in again
- Desktop view (wide browser window):
  - Verify top navigation bar with Fuelion heading on left
  - Verify "Pojazdy" and "Statystyki" buttons visible
  - Verify language toggle button (PL/EN)
  - Verify user avatar on right
- Mobile view (resize browser < 768px wide):
  - Verify top navigation disappears
  - Verify bottom navigation bar appears (fixed at bottom)
  - Verify two icon buttons: car icon (Pojazdy) and chart icon (Statystyki)
  - Verify labels below icons are small text

**5. Internationalization (i18n)**

- While signed in (desktop or mobile view)
- Click language toggle button (shows "PL" or "EN")
- Verify interface switches language:
  - Navigation links change (Pojazdy ↔ Vehicles, Statystyki ↔ Statistics)
  - Sign-in button text changes
  - Welcome message language changes
- Toggle back and forth - should work smoothly

**6. UIUX-06: Loading States**

- Visit http://localhost:3000 while signed out
- Should briefly see SkeletonLoader (page variant) during session check before redirect
- Check that SkeletonLoader exists: `ls components/ui/SkeletonLoader.tsx`
- Check that Loading component still exists: `ls components/Loading.tsx`
- Note: Full loading state testing with data fetching will happen in Phase 2+
- Verify components build without errors: `npm run build`

**7. UIUX-06: Error States**

- Check that ErrorAlert exists: `ls components/ui/ErrorAlert.tsx`
- Check that FetchDataErrorAlert exists: `ls components/errors/FetchDataErrorAlert.tsx`
- Note: Full error state testing with actual errors will happen in Phase 2+ when data fetching is implemented
- For now, verify components build without errors: `npm run build`

**8. Code Quality**

- Run build: `npm run build`
- Should complete without TypeScript errors
- Should complete without ESLint errors
- Run linter: `npm run lint`
- Should pass or show only warnings (no errors)

**Success Indicators:**
✓ Google OAuth sign-in works end-to-end
✓ Session persists across browser restart
✓ Sign-out redirects to sign-in page correctly
✓ Navigation adapts between desktop (top) and mobile (bottom)
✓ Language toggle switches between Polish and English
✓ SkeletonLoader displays during index page session loading
✓ Build completes without errors
✓ All Phase 1 requirements (AUTH-01, AUTH-02, AUTH-03, AUTH-04, UIUX-01, UIUX-06) verified

**If Issues Found:**

- Document specific failing test
- Include browser console errors if any
- Note which requirement is not met
- Include screenshots if visual issues
  </how-to-verify>
  <resume-signal>
  Type "approved" if all tests pass, or describe specific issues found for debugging.
  </resume-signal>
  </task>

</tasks>

<verification>
Human verification covers:
1. Complete auth flow (sign-in, session persistence, sign-out)
2. Responsive navigation (desktop top bar, mobile bottom bar)
3. Language switching (Polish ↔ English)
4. Protected route behavior (redirects when unauthenticated)
5. Code quality (builds without errors)
</verification>

<success_criteria>

1. User can sign in with Google OAuth - AUTH-01 ✓
2. Session persists across browser restart - AUTH-02 ✓
3. User can sign out from navigation menu - AUTH-03 ✓
4. Unauthenticated users are redirected to sign-in - AUTH-04 ✓
5. Navigation adapts responsively (desktop/mobile) - UIUX-01 ✓
6. Language toggle works between Polish and English - i18n ✓
7. SkeletonLoader displays on index page loading state - UIUX-06 ✓
8. ErrorAlert and SkeletonLoader components exist and build correctly - UIUX-06 ✓
9. No TypeScript or build errors
   </success_criteria>

<output>
After human verification approval, create `.planning/phases/01-auth-app-shell/01-05-SUMMARY.md`

Document any issues found during verification in the summary for addressing before Phase 2.
</output>
